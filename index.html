<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document - NotePad</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #202020;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .top-bar {
            background: #2d2d2d;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            border-bottom: 1px solid #3a3a3a;
        }

        .doc-title {
            color: #ffffff;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .doc-title input {
            background: transparent;
            border: 1px solid transparent;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 14px;
        }

        .doc-title input:hover {
            border-color: #4a4a4a;
        }

        .doc-title input:focus {
            outline: none;
            border-color: #0078d4;
            background: #383838;
        }

        .top-bar-right {
            display: flex;
            gap: 8px;
        }

        .top-btn {
            background: transparent;
            border: 1px solid #4a4a4a;
            color: #e0e0e0;
            padding: 6px 14px;
            font-size: 12px;
            cursor: pointer;
            border-radius: 3px;
        }

        .top-btn:hover {
            background: #3a3a3a;
        }

        .menu-bar {
            background: #2d2d2d;
            display: flex;
            padding: 0 12px;
            border-bottom: 1px solid #3a3a3a;
            height: 40px;
        }

        .menu-item {
            color: #e0e0e0;
            padding: 6px 14px;
            font-size: 13px;
            background: transparent;
            border: none;
            cursor: pointer;
            border-radius: 3px;
        }

        .menu-item:hover {
            background: #3a3a3a;
        }

        .menu-item.active {
            background: #3a3a3a;
        }

        .ribbon {
            background: #2d2d2d;
            padding: 8px 16px;
            border-bottom: 1px solid #3a3a3a;
            overflow-x: auto;
        }

        .ribbon-content {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .ribbon-group {
            display: flex;
            gap: 4px;
            padding: 0 12px;
            border-right: 1px solid #3a3a3a;
        }

        .ribbon-group:last-child {
            border-right: none;
        }

        .ribbon-btn {
            background: transparent;
            border: 1px solid transparent;
            color: #e0e0e0;
            padding: 6px 10px;
            font-size: 13px;
            cursor: pointer;
            border-radius: 3px;
            white-space: nowrap;
        }

        .ribbon-btn:hover {
            background: #3a3a3a;
        }

        .ribbon-btn.active {
            background: #0078d4;
        }

        select {
            background: #383838;
            border: 1px solid #4a4a4a;
            color: #e0e0e0;
            padding: 5px 8px;
            font-size: 12px;
            border-radius: 3px;
            cursor: pointer;
        }

        input[type="color"] {
            width: 32px;
            height: 28px;
            border: 1px solid #4a4a4a;
            border-radius: 3px;
            cursor: pointer;
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            background: #1a1a1a;
            display: flex;
            justify-content: center;
            padding: 24px;
        }

        .pages-container {
            width: 100%;
            max-width: 850px;
        }

        .page {
            background: #ffffff;
            width: 100%;
            min-height: 1100px;
            padding: 96px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin-bottom: 30px;
            position: relative;
        }

        .page:last-child {
            margin-bottom: 0;
        }

        .page-content {
            outline: none;
            font-family: Calibri, Arial, sans-serif;
            font-size: 11pt;
            line-height: 1.6;
            color: #000000;
            min-height: 900px;
        }

        .page-number {
            position: absolute;
            bottom: 50px;
            right: 96px;
            color: #999;
            font-size: 10pt;
            user-select: none;
        }

        .status-bar {
            background: #2d2d2d;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            border-top: 1px solid #3a3a3a;
            color: #b0b0b0;
            font-size: 11px;
        }

        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .zoom-slider {
            width: 100px;
        }

        /* Light Theme */
        body.light-theme {
            background: #f0f0f0;
        }

        body.light-theme .top-bar,
        body.light-theme .menu-bar,
        body.light-theme .ribbon,
        body.light-theme .status-bar {
            background: #ffffff;
            border-color: #d0d0d0;
        }

        body.light-theme .menu-item,
        body.light-theme .ribbon-btn,
        body.light-theme .top-btn,
        body.light-theme .doc-title,
        body.light-theme .doc-title input {
            color: #1a1a1a;
        }

        body.light-theme .main-content {
            background: #e5e5e5;
        }

        body.light-theme select {
            background: #ffffff;
            border-color: #d0d0d0;
            color: #1a1a1a;
        }

        /* Find/Replace Dialog */
        .dialog {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #2d2d2d;
            border: 1px solid #3a3a3a;
            border-radius: 8px;
            padding: 20px;
            z-index: 1000;
            min-width: 400px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        .dialog.show {
            display: block;
        }

        .dialog-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        .dialog-overlay.show {
            display: block;
        }

        .dialog h3 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }

        .dialog input[type="text"] {
            width: 100%;
            padding: 8px;
            background: #383838;
            border: 1px solid #4a4a4a;
            color: #e0e0e0;
            border-radius: 3px;
            margin-bottom: 10px;
        }

        .dialog-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 15px;
        }

        .dialog-btn {
            padding: 8px 16px;
            background: #4a4a4a;
            border: none;
            color: #e0e0e0;
            border-radius: 3px;
            cursor: pointer;
        }

        .dialog-btn:hover {
            background: #5a5a5a;
        }

        .dialog-btn.primary {
            background: #0078d4;
        }

        .dialog-btn.primary:hover {
            background: #1084e0;
        }

        /* Table styles */
        .page-content table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
        }

        .page-content table td, .page-content table th {
            border: 1px solid #333;
            padding: 8px;
            min-width: 80px;
        }

        .page-content table th {
            background: #f0f0f0;
            font-weight: bold;
        }

        @media print {
            body {
                background: white;
            }
            .top-bar, .menu-bar, .ribbon, .status-bar {
                display: none;
            }
            .main-content {
                padding: 0;
                background: white;
            }
            .page {
                page-break-after: always;
                margin-bottom: 0;
                box-shadow: none;
            }
            .page:last-child {
                page-break-after: auto;
            }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="doc-title">
            <span>üìÑ</span>
            <input type="text" id="docTitle" value="Untitled Document" onchange="updateDocTitle()">
        </div>
        <div class="top-bar-right">
            <button class="top-btn" onclick="autoSave()">üíæ Save</button>
            <button class="top-btn" onclick="exportDocument()">üì• Export</button>
            <button class="top-btn" onclick="showLogin()">Login</button>
        </div>
    </div>

    <div class="menu-bar">
        <button class="menu-item active" onclick="changeTab('home')">Home</button>
        <button class="menu-item" onclick="changeTab('insert')">Insert</button>
        <button class="menu-item" onclick="changeTab('layout')">Layout</button>
        <button class="menu-item" onclick="changeTab('review')">Review</button>
        <button class="menu-item" onclick="changeTab('view')">View</button>
    </div>

    <div class="ribbon">
        <!-- HOME TAB -->
        <div class="ribbon-content" id="homeRibbon">
            <div class="ribbon-group">
                <select onchange="applyFormat('fontName', this.value)">
                    <option>Calibri</option>
                    <option>Arial</option>
                    <option>Times New Roman</option>
                    <option>Georgia</option>
                    <option>Courier New</option>
                    <option>Verdana</option>
                    <option>Comic Sans MS</option>
                </select>
                
                <select onchange="applyFormat('fontSize', this.value)">
                    <option value="1">8pt</option>
                    <option value="2">10pt</option>
                    <option value="3" selected>11pt</option>
                    <option value="4">12pt</option>
                    <option value="5">14pt</option>
                    <option value="6">18pt</option>
                    <option value="7">24pt</option>
                </select>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="applyFormat('bold')" id="boldBtn" title="Bold (Ctrl+B)">
                    <strong>B</strong>
                </button>
                <button class="ribbon-btn" onclick="applyFormat('italic')" id="italicBtn" title="Italic (Ctrl+I)">
                    <em>I</em>
                </button>
                <button class="ribbon-btn" onclick="applyFormat('underline')" id="underlineBtn" title="Underline (Ctrl+U)">
                    <u>U</u>
                </button>
                <button class="ribbon-btn" onclick="applyFormat('strikeThrough')" title="Strikethrough">
                    <s>S</s>
                </button>
                <button class="ribbon-btn" onclick="applyFormat('subscript')" title="Subscript">
                    X‚ÇÇ
                </button>
                <button class="ribbon-btn" onclick="applyFormat('superscript')" title="Superscript">
                    X¬≤
                </button>
            </div>

            <div class="ribbon-group">
                <input type="color" id="textColor" value="#000000" onchange="applyFormat('foreColor', this.value)" title="Text Color">
                <input type="color" id="bgColor" value="#ffff00" onchange="applyFormat('hiliteColor', this.value)" title="Highlight">
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="applyFormat('justifyLeft')" title="Align Left">‚ò∞</button>
                <button class="ribbon-btn" onclick="applyFormat('justifyCenter')" title="Center">‚ò∞</button>
                <button class="ribbon-btn" onclick="applyFormat('justifyRight')" title="Align Right">‚ò∞</button>
                <button class="ribbon-btn" onclick="applyFormat('justifyFull')" title="Justify">‚ò∞</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="applyFormat('insertUnorderedList')" title="Bullets">‚Ä¢ List</button>
                <button class="ribbon-btn" onclick="applyFormat('insertOrderedList')" title="Numbering">1. List</button>
                <button class="ribbon-btn" onclick="decreaseIndent()" title="Decrease Indent">‚óÇ</button>
                <button class="ribbon-btn" onclick="increaseIndent()" title="Increase Indent">‚ñ∏</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="applyFormat('undo')" title="Undo (Ctrl+Z)">‚Ü∂</button>
                <button class="ribbon-btn" onclick="applyFormat('redo')" title="Redo (Ctrl+Y)">‚Ü∑</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="showFindReplace()" title="Find & Replace (Ctrl+F)">üîç Find</button>
                <button class="ribbon-btn" onclick="applyFormat('removeFormat')" title="Clear Formatting">üóëÔ∏è</button>
            </div>
        </div>

        <!-- INSERT TAB -->
        <div class="ribbon-content" id="insertRibbon" style="display: none;">
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="insertPageBreak()">üìÑ Page Break</button>
                <button class="ribbon-btn" onclick="insertTable()">‚äû Table</button>
                <button class="ribbon-btn" onclick="insertImage()">üñºÔ∏è Image</button>
                <button class="ribbon-btn" onclick="insertLink()">üîó Link</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="insertHorizontalRule()">‚ûñ Horizontal Line</button>
                <button class="ribbon-btn" onclick="insertDate()">üìÖ Date/Time</button>
                <button class="ribbon-btn" onclick="insertSymbol()">Œ© Symbol</button>
            </div>
        </div>

        <!-- LAYOUT TAB -->
        <div class="ribbon-content" id="layoutRibbon" style="display: none;">
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="setMargins('narrow')">üìè Narrow Margins</button>
                <button class="ribbon-btn" onclick="setMargins('normal')">üìè Normal Margins</button>
                <button class="ribbon-btn" onclick="setMargins('wide')">üìè Wide Margins</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="setOrientation('portrait')">üìÑ Portrait</button>
                <button class="ribbon-btn" onclick="setOrientation('landscape')">üìÑ Landscape</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="setLineSpacing(1.0)">1.0 Spacing</button>
                <button class="ribbon-btn" onclick="setLineSpacing(1.5)">1.5 Spacing</button>
                <button class="ribbon-btn" onclick="setLineSpacing(2.0)">2.0 Spacing</button>
            </div>
        </div>

        <!-- REVIEW TAB -->
        <div class="ribbon-content" id="reviewRibbon" style="display: none;">
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="spellCheck()">‚úì Spell Check</button>
                <button class="ribbon-btn" onclick="wordCount()">üìä Word Count</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="addComment()">üí¨ Comment</button>
                <button class="ribbon-btn" onclick="trackChanges()">üìù Track Changes</button>
            </div>
        </div>

        <!-- VIEW TAB -->
        <div class="ribbon-content" id="viewRibbon" style="display: none;">
            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="toggleTheme()">üåì Theme</button>
                <button class="ribbon-btn" onclick="zoomIn()">üîç+ Zoom In</button>
                <button class="ribbon-btn" onclick="zoomOut()">üîç- Zoom Out</button>
                <button class="ribbon-btn" onclick="resetZoom()">100% Reset</button>
            </div>

            <div class="ribbon-group">
                <button class="ribbon-btn" onclick="fullScreen()">‚õ∂ Full Screen</button>
                <button class="ribbon-btn" onclick="readingMode()">üìñ Reading Mode</button>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="pages-container" id="pagesContainer">
            <div class="page" data-page="1">
                <div class="page-content" contenteditable="true" spellcheck="true"></div>
                <div class="page-number">Page 1</div>
            </div>
        </div>
    </div>

    <div class="status-bar">
        <span id="wordCount">0 words | 0 characters</span>
        <span id="pageInfo">Page 1 of 1</span>
        <div class="zoom-controls">
            <button class="ribbon-btn" onclick="zoomOut()">‚àí</button>
            <input type="range" class="zoom-slider" min="50" max="200" value="100" id="zoomSlider" oninput="updateZoom(this.value)">
            <button class="ribbon-btn" onclick="zoomIn()">+</button>
            <span id="zoomLevel">100%</span>
        </div>
    </div>

    <!-- Find/Replace Dialog -->
    <div class="dialog-overlay" id="dialogOverlay" onclick="closeFindReplace()"></div>
    <div class="dialog" id="findDialog">
        <h3>Find and Replace</h3>
        <input type="text" id="findText" placeholder="Find...">
        <input type="text" id="replaceText" placeholder="Replace with...">
        <div class="dialog-buttons">
            <button class="dialog-btn" onclick="closeFindReplace()">Cancel</button>
            <button class="dialog-btn" onclick="findNext()">Find Next</button>
            <button class="dialog-btn primary" onclick="replaceAll()">Replace All</button>
        </div>
    </div>

    <script>
        let currentZoom = 100;
        const MAX_PAGE_HEIGHT = 900;

        function getAllPageContents() {
            return document.querySelectorAll('.page-content');
        }

        function getCurrentPageContent() {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                const pageContent = range.commonAncestorContainer.nodeType === 3 
                    ? range.commonAncestorContainer.parentElement.closest('.page-content')
                    : range.commonAncestorContainer.closest('.page-content');
                return pageContent || getAllPageContents()[0];
            }
            return getAllPageContents()[0];
        }

        function applyFormat(cmd, value) {
            try {
                if (value === undefined) value = null;
                document.execCommand(cmd, false, value);
                const pageContent = getCurrentPageContent();
                if (pageContent) pageContent.focus();
                updateButtons();
            } catch(e) {
                console.error('Format error:', e);
            }
        }

        function updateButtons() {
            try {
                const boldBtn = document.getElementById('boldBtn');
                const italicBtn = document.getElementById('italicBtn');
                const underlineBtn = document.getElementById('underlineBtn');
                
                if (boldBtn) boldBtn.classList.toggle('active', document.queryCommandState('bold'));
                if (italicBtn) italicBtn.classList.toggle('active', document.queryCommandState('italic'));
                if (underlineBtn) underlineBtn.classList.toggle('active', document.queryCommandState('underline'));
            } catch(e) {}
        }

        function checkPageOverflow() {
            const pages = document.querySelectorAll('.page');
            const lastPage = pages[pages.length - 1];
            const lastPageContent = lastPage.querySelector('.page-content');
            
            if (lastPageContent && lastPageContent.scrollHeight > MAX_PAGE_HEIGHT) {
                createNewPage();
            }
        }

        function createNewPage() {
            const container = document.getElementById('pagesContainer');
            const pages = container.querySelectorAll('.page');
            const newPageNumber = pages.length + 1;
            
            const newPage = document.createElement('div');
            newPage.className = 'page';
            newPage.setAttribute('data-page', newPageNumber);
            newPage.innerHTML = `
                <div class="page-content" contenteditable="true" spellcheck="true"></div>
                <div class="page-number">Page ${newPageNumber}</div>
            `;
            
            container.appendChild(newPage);
            setupPageListeners(newPage.querySelector('.page-content'));
            updatePageCount();
        }

        function insertPageBreak() {
            const currentPageContent = getCurrentPageContent();
            if (currentPageContent) {
                createNewPage();
                const pages = document.querySelectorAll('.page-content');
                pages[pages.length - 1].focus();
            }
        }

        function updateWordCount() {
            try {
                let totalText = '';
                getAllPageContents().forEach(page => {
                    totalText += page.innerText || '';
                });
                const words = totalText.trim().split(/\s+/).filter(w => w.length > 0).length;
                const chars = totalText.length;
                document.getElementById('wordCount').textContent = `${words} words | ${chars} characters`;
            } catch(e) {}
        }

        function updatePageCount() {
            const pageCount = document.querySelectorAll('.page').length;
            document.getElementById('pageInfo').textContent = `Page ${pageCount} of ${pageCount}`;
        }

        function setupPageListeners(pageContent) {
            pageContent.addEventListener('input', function() {
                updateWordCount();
                checkPageOverflow();
                updateButtons();
                autoSave();
            });

            pageContent.addEventListener('mouseup', updateButtons);
            pageContent.addEventListener('keyup', updateButtons);
            
            pageContent.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    setTimeout(() => checkPageOverflow(), 10);
                }
            });
        }

        function changeTab(tabName) {
            try {
                document.querySelectorAll('.ribbon-content').forEach(r => {
                    r.style.display = 'none';
                });
                
                const ribbon = document.getElementById(tabName + 'Ribbon');
                if (ribbon) {
                    ribbon.style.display = 'flex';
                }
                
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.classList.remove('active');
                });
                event.target.classList.add('active');
            } catch(e) {}
        }

        // INSERT FEATURES
        function insertTable() {
            const rows = prompt('Number of rows:', '3');
            const cols = prompt('Number of columns:', '3');
            if (rows && cols) {
                let table = '<table><tbody>';
                for (let i = 0; i < rows; i++) {
                    table += '<tr>';
                    for (let j = 0; j < cols; j++) {
                        table += i === 0 ? '<th>Header</th>' : '<td>Cell</td>';
                    }
                    table += '</tr>';
                }
                table += '</tbody></table>';
                applyFormat('insertHTML', table);
            }
        }

        function insertImage() {
            const url = prompt('Enter image URL:');
            if (url) {
                applyFormat('insertImage', url);
            }
        }

        function insertLink() {
            const url = prompt('Enter URL:');
            if (url) {
                applyFormat('createLink', url);
            }
        }

        function insertHorizontalRule() {
            applyFormat('insertHorizontalRule');
        }

        function insertDate() {
            const now = new Date();
            const dateStr = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
            applyFormat('insertText', dateStr);
        }

        function insertSymbol() {
            const symbols = ['¬©', '¬Æ', '‚Ñ¢', '¬ß', '¬∂', '‚Ä†', '‚Ä°', '‚Ä¢', '¬∞', '¬±', '√ó', '√∑', '‚âà', '‚â†', '‚â§', '‚â•', 'Œ±', 'Œ≤', 'Œ≥', 'œÄ', 'Œ£', '‚àû'];
            const symbol = prompt('Choose symbol:\n' + symbols.join(' '));
            if (symbol) {
                applyFormat('insertText', symbol);
            }
        }

        // LAYOUT FEATURES
        function setMargins(type) {
            const page = document.querySelector('.page');
            switch(type) {
                case 'narrow':
                    page.style.padding = '48px';
                    break;
                case 'normal':
                    page.style.padding = '96px';
                    break;
                case 'wide':
                    page.style.padding = '144px';
                    break;
            }
        }

        function setOrientation(orientation) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                if (orientation === 'landscape') {
                    page.style.width = '1100px';
                    page.style.minHeight = '850px';
                } else {
                    page.style.width = '100%';
                    page.style.minHeight = '1100px';
                }
            });
        }

        function setLineSpacing(spacing) {
            const pageContent = getCurrentPageContent();
            if (pageContent) {
                pageContent.style.lineHeight = spacing;
            }
        }

        function decreaseIndent() {
            applyFormat('outdent');
        }

        function increaseIndent() {
            applyFormat('indent');
        }

        // REVIEW FEATURES
        function spellCheck() {
            const pageContent = getCurrentPageContent();
            if (pageContent) {
                const hasSpellcheck = pageContent.getAttribute('spellcheck') === 'true';
                pageContent.setAttribute('spellcheck', !hasSpellcheck);
                alert(hasSpellcheck ? 'Spell check disabled' : 'Spell check enabled');
            }
        }

        function wordCount() {
            let totalText = '';
            getAllPageContents().forEach(page => {
                totalText += page.innerText || '';
            });
            const words = totalText.trim().split(/\s+/).filter(w => w.length > 0).length;
            const chars = totalText.length;
            const charsNoSpaces = totalText.replace(/\s/g, '').length;
            const sentences = totalText.split(/[.!?]+/).filter(s => s.trim().length > 0).length;
            const paragraphs = totalText.split(/\n\n+/).filter(p => p.trim().length > 0).length;
            
            alert(`Word Count Statistics:\n\nWords: ${words}\nCharacters (with spaces): ${chars}\nCharacters (no spaces): ${charsNoSpaces}\nSentences: ${sentences}\nParagraphs: ${paragraphs}`);
        }

        function addComment() {
            const comment = prompt('Add comment:');
            if (comment) {
                const selection = window.getSelection();
                if (selection.toString()) {
                    const span = document.createElement('span');
                    span.style.backgroundColor = '#ffeb3b';
                    span.title = 'Comment: ' + comment;
                    span.innerHTML = selection.toString();
                    selection.getRangeAt(0).deleteContents();
                    selection.getRangeAt(0).insertNode(span);
                }
            }
        }

        function trackChanges() {
            alert('Track Changes feature - Would track all edits in a real implementation');
        }

        // FIND/REPLACE
        function showFindReplace() {
            document.getElementById('dialogOverlay').classList.add('show');
            document.getElementById('findDialog').classList.add('show');
            document.getElementById('findText').focus();
        }

        function closeFindReplace() {
            document.getElementById('dialogOverlay').classList.remove('show');
            document.getElementById('findDialog').classList.remove('show');
        }

        function findNext() {
            const text = document.getElementById('findText').value;
            if (text) {
                window.find(text);
            }
        }

        function replaceAll() {
            const findText = document.getElementById('findText').value;
            const replaceText = document.getElementById('replaceText').value;
            
            if (findText) {
                getAllPageContents().forEach(page => {
                    const content = page.innerHTML;
                    page.innerHTML = content.replace(new RegExp(findText, 'g'), replaceText);
                });
                closeFindReplace();
            }
        }

        // VIEW FEATURES
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }

        function updateZoom(value) {
            currentZoom = parseInt(value);
            const container = document.getElementById('pagesContainer');
            container.style.transform = `scale(${currentZoom / 100})`;
            container.style.transformOrigin = 'top center';
            document.getElementById('zoomLevel').textContent = currentZoom + '%';
        }

        function zoomIn() {
            const slider = document.getElementById('zoomSlider');
            const newValue = Math.min(200, currentZoom + 10);
            slider.value = newValue;
            updateZoom(newValue);
        }

        function zoomOut() {
            const slider = document.getElementById('zoomSlider');
            const newValue = Math.max(50, currentZoom - 10);
            slider.value = newValue;
            updateZoom(newValue);
        }

        function resetZoom() {
            document.getElementById('zoomSlider').value = 100;
            updateZoom(100);
        }

        function fullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        function readingMode() {
            document.querySelector('.top-bar').style.display = 'none';
            document.querySelector('.menu-bar').style.display = 'none';
            document.querySelector('.ribbon').style.display = 'none';
            alert('Reading Mode - Press ESC to exit');
            
            document.addEventListener('keydown', function exitReading(e) {
                if (e.key === 'Escape') {
                    document.querySelector('.top-bar').style.display = 'flex';
                    document.querySelector('.menu-bar').style.display = 'flex';
                    document.querySelector('.ribbon').style.display = 'block';
                    document.removeEventListener('keydown', exitReading);
                }
            });
        }

        // FILE OPERATIONS
        function updateDocTitle() {
            const title = document.getElementById('docTitle').value;
            document.title = title + ' - NotePad';
            autoSave();
        }

        function autoSave() {
            try {
                const data = {
                    title: document.getElementById('docTitle').value,
                    pages: []
                };
                getAllPageContents().forEach(page => {
                    data.pages.push(page.innerHTML);
                });
                localStorage.setItem('notepad-document', JSON.stringify(data));
                console.log('Auto-saved');
            } catch(e) {
                console.error('Save error:', e);
            }
        }

        function exportDocument() {
            const format = prompt('Export as:\n1. HTML\n2. Plain Text\n3. PDF (Print)\n\nEnter 1, 2, or 3:', '1');
            
            if (format === '1') {
                let html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><title>' + document.getElementById('docTitle').value + '</title>';
                html += '<style>body{font-family:Calibri,Arial;max-width:850px;margin:0 auto;padding:96px}.page{page-break-after:always}</style></head><body>';
                getAllPageContents().forEach((page, i) => {
                    html += '<div class="page">' + page.innerHTML + '</div>';
                });
                html += '</body></html>';
                
                const blob = new Blob([html], { type: 'text/html' });
                downloadFile(blob, document.getElementById('docTitle').value + '.html');
            } else if (format === '2') {
                let text = '';
                getAllPageContents().forEach(page => {
                    text += page.innerText + '\n\n';
                });
                const blob = new Blob([text], { type: 'text/plain' });
                downloadFile(blob, document.getElementById('docTitle').value + '.txt');
            } else if (format === '3') {
                window.print();
            }
        }

        function downloadFile(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function showLogin() {
            alert('Login functionality - ready for implementation!');
        }

        // KEYBOARD SHORTCUTS
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key.toLowerCase()) {
                    case 'b':
                        e.preventDefault();
                        applyFormat('bold');
                        break;
                    case 'i':
                        e.preventDefault();
                        applyFormat('italic');
                        break;
                    case 'u':
                        e.preventDefault();
                        applyFormat('underline');
                        break;
                    case 's':
                        e.preventDefault();
                        autoSave();
                        alert('Document saved!');
                        break;
                    case 'f':
                        e.preventDefault();
                        showFindReplace();
                        break;
                    case 'p':
                        e.preventDefault();
                        window.print();
                        break;
                    case 'z':
                        if (!e.shiftKey) {
                            e.preventDefault();
                            applyFormat('undo');
                        }
                        break;
                    case 'y':
                        e.preventDefault();
                        applyFormat('redo');
                        break;
                }
            }
        });

        // INITIALIZATION
        window.addEventListener('load', function() {
            try {
                const saved = localStorage.getItem('notepad-document');
                if (saved) {
                    const data = JSON.parse(saved);
                    document.getElementById('docTitle').value = data.title || 'Untitled Document';
                    
                    const container = document.getElementById('pagesContainer');
                    container.innerHTML = '';
                    
                    data.pages.forEach((content, index) => {
                        const pageNum = index + 1;
                        const page = document.createElement('div');
                        page.className = 'page';
                        page.setAttribute('data-page', pageNum);
                        page.innerHTML = `
                            <div class="page-content" contenteditable="true" spellcheck="true">${content}</div>
                            <div class="page-number">Page ${pageNum}</div>
                        `;
                        container.appendChild(page);
                        setupPageListeners(page.querySelector('.page-content'));
                    });
                }
            } catch(e) {
                console.error('Load error:', e);
            }
            
            const firstPage = document.querySelector('.page-content');
            if (firstPage && !firstPage.innerHTML.trim()) {
                setupPageListeners(firstPage);
            }
            
            updateWordCount();
            updatePageCount();
            
            // Load theme
            if (localStorage.getItem('theme') === 'light') {
                document.body.classList.add('light-theme');
            }
        });
    </script>
</body>
</html>
